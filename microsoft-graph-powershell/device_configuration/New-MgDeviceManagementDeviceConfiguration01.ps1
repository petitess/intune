Get-MgDeviceManagementDeviceConfiguration | Select-Object DisplayName, Id, AdditionalProperties # | ConvertTo-Json
Get-MgDeviceManagementDeviceConfiguration | Where-Object DisplayName -eq "SecurityBaseline Windows 10 Device Restrictions" | Select-Object AdditionalProperties | ConvertTo-Json

$params = @{
    "@odata.type" = "#microsoft.graph.windows10GeneralConfiguration"
    description = "Test"
    displayName = "Windows 10 General Configuration - Test"
    networkProxyApplySettingsDeviceWide = $false
    networkProxyDisableAutoDetect = $false
    personalizationDesktopImageUrl = "https://wallpaperaccess.com/full/5324597.jpg"
    bluetoothAllowedServices = @()
    bluetoothBlockAdvertising = $false
    bluetoothBlockDiscoverableMode = $false
    bluetoothBlockPrePairing = $false
    edgeBlockAutofill = $false
    edgeBlocked = $false
    edgeCookiePolicy = "userDefined"
    edgeBlockDeveloperTools = $false
    edgeBlockSendingDoNotTrackHeader = $false
    edgeBlockExtensions = $false
    edgeBlockInPrivateBrowsing = $false
    edgeBlockJavaScript = $false
    edgeBlockPasswordManager = $false
    edgeBlockAddressBarDropdown = $false
    edgeBlockCompatibilityList = $false
    edgeClearBrowsingDataOnExit = $false
    edgeAllowStartPagesModification = $false
    edgeDisableFirstRunPage = $false
    edgeBlockLiveTileDataCollection = $false
    edgeSyncFavoritesWithInternetExplorer = $false
    cellularBlockDataWhenRoaming = $false
    cellularBlockVpn = $false
    cellularBlockVpnWhenRoaming = $false
    defenderRequireRealTimeMonitoring = $true
    defenderRequireBehaviorMonitoring = $true
    defenderRequireNetworkInspectionSystem = $true
    defenderScanDownloads = $true
    defenderScanScriptsLoadedInInternetExplorer = $true
    defenderBlockEndUserAccess = $false
    defenderMonitorFileActivity = "userDefined"
    defenderDaysBeforeDeletingQuarantinedMalware = 14
    defenderScanMaxCpu = 15
    defenderScanArchiveFiles = $true
    defenderScanIncomingMail = $true
    defenderScanRemovableDrivesDuringFullScan = $true
    defenderScanMappedNetworkDrivesDuringFullScan = $false
    defenderScanNetworkFiles = $false
    defenderRequireCloudProtection = $true
    defenderCloudBlockLevel = "notConfigured"
    defenderPromptForSampleSubmission = "userDefined"
    defenderScheduledQuickScanTime = "12:00:00.0000000"
    defenderScanType = "full"
    defenderSystemScanSchedule = "wednesday"
    defenderScheduledScanTime = "16:00:00.0000000"
    defenderFileExtensionsToExclude = @()
    defenderFilesAndFoldersToExclude = @(
    "%AppData%\\Caesar\\webCRM\\Documents"
    )
    defenderProcessesToExclude = @()
    lockScreenAllowTimeoutConfiguration = $false
    lockScreenBlockActionCenterNotifications = $false
    lockScreenBlockCortana = $true
    lockScreenBlockToastNotifications = $true
    passwordBlockSimple = $false
    passwordRequired = $false
    passwordRequireWhenResumeFromIdleState = $false
    passwordRequiredType = "deviceDefault"
    privacyAdvertisingId = "notConfigured"
    privacyAutoAcceptPairingAndConsentPrompts = $false
    privacyBlockInputPersonalization = $false
    searchBlockDiacritics = $false
    searchDisableAutoLanguageDetection = $false
    searchDisableIndexingEncryptedItems = $false
    searchEnableRemoteQueries = $false
    searchDisableIndexerBackoff = $false
    searchDisableIndexingRemovableDrive = $false
    searchEnableAutomaticIndexSizeManangement = $false
    settingsBlockSettingsApp = $false
    settingsBlockSystemPage = $false
    settingsBlockDevicesPage = $false
    settingsBlockNetworkInternetPage = $false
    settingsBlockPersonalizationPage = $false
    settingsBlockAccountsPage = $false
    settingsBlockTimeLanguagePage = $false
    settingsBlockEaseOfAccessPage = $false
    settingsBlockPrivacyPage = $false
    settingsBlockUpdateSecurityPage = $false
    settingsBlockAppsPage = $false
    settingsBlockGamingPage = $false
    smartScreenEnableAppInstallControl = $false
    startBlockUnpinningAppsFromTaskbar = $false
    startMenuAppListVisibility = "userDefined"
    startMenuHideChangeAccountSettings = $false
    startMenuHideFrequentlyUsedApps = $false
    startMenuHideHibernate = $false
    startMenuHideLock = $false
    startMenuHidePowerButton = $false
    startMenuHideRecentJumpLists = $false
    startMenuHideRecentlyAddedApps = $false
    startMenuHideRestartOptions = $false
    startMenuHideShutDown = $false
    startMenuHideSignOut = $false
    startMenuHideSleep = $false
    startMenuHideSwitchAccount = $false
    startMenuHideUserTile = $false
    startMenuMode = "userDefined"
    startMenuPinnedFolderDocuments = "notConfigured"
    startMenuPinnedFolderDownloads = "notConfigured"
    startMenuPinnedFolderFileExplorer = "notConfigured"
    startMenuPinnedFolderHomeGroup = "notConfigured"
    startMenuPinnedFolderMusic = "notConfigured"
    startMenuPinnedFolderNetwork = "notConfigured"
    startMenuPinnedFolderPersonalFolder = "notConfigured"
    startMenuPinnedFolderPictures = "notConfigured"
    startMenuPinnedFolderSettings = "notConfigured"
    startMenuPinnedFolderVideos = "notConfigured"
    diagnosticsDataSubmissionMode = "basic"
    oneDriveDisableFileSync = $false
    windowsSpotlightBlockConsumerSpecificFeatures = $false
    windowsSpotlightBlocked = $true
    windowsSpotlightBlockOnActionCenter = $false
    windowsSpotlightBlockTailoredExperiences = $false
    windowsSpotlightBlockThirdPartyNotifications = $false
    windowsSpotlightBlockWelcomeExperience = $false
    windowsSpotlightBlockWindowsTips = $false
    windowsSpotlightConfigureOnLockScreen = "notConfigured"
    accountsBlockAddingNonMicrosoftAccountEmail = $false
    antiTheftModeBlocked = $false
    bluetoothBlocked = $false
    cameraBlocked = $false
    connectedDevicesServiceBlocked = $false
    certificatesBlockManualRootCertificateInstallation = $false
    copyPasteBlocked = $false
    cortanaBlocked = $false
    deviceManagementBlockFactoryResetOnMobile = $false
    deviceManagementBlockManualUnenroll = $false
    safeSearchFilter = "userDefined"
    edgeBlockPopups = $false
    edgeBlockSearchSuggestions = $false
    edgeBlockSendingIntranetTrafficToInternetExplorer = $false
    edgeSendIntranetTrafficToInternetExplorer = $false
    edgeRequireSmartScreen = $false
    edgeHomepageUrls = @()
    edgeBlockAccessToAboutFlags = $false
    smartScreenBlockPromptOverride = $true
    smartScreenBlockPromptOverrideForFiles = $true
    webRtcBlockLocalhostIpAddress = $false
    internetSharingBlocked = $false
    settingsBlockAddProvisioningPackage = $false
    settingsBlockRemoveProvisioningPackage = $false
    settingsBlockChangeSystemTime = $false
    settingsBlockEditDeviceName = $false
    settingsBlockChangeRegion = $false
    settingsBlockChangeLanguage = $false
    settingsBlockChangePowerSleep = $false
    locationServicesBlocked = $false
    microsoftAccountBlocked = $true
    microsoftAccountBlockSettingsSync = $true
    nfcBlocked = $false
    resetProtectionModeBlocked = $false
    screenCaptureBlocked = $false
    storageBlockRemovableStorage = $false
    storageRequireMobileDeviceEncryption = $false
    usbBlocked = $false
    voiceRecordingBlocked = $false
    wiFiBlockAutomaticConnectHotspots = $true
    wiFiBlocked = $false
    wiFiBlockManualConfiguration = $false
    wirelessDisplayBlockProjectionToThisDevice = $false
    wirelessDisplayBlockUserInputFromReceiver = $false
    wirelessDisplayRequirePinForPairing = $false
    windowsStoreBlocked = $false
    appsAllowTrustedAppsSideloading = "notConfigured"
    windowsStoreBlockAutoUpdate = $false
    developerUnlockSetting = "notConfigured"
    sharedUserAppDataAllowed = $false
    appsBlockWindowsStoreOriginatedApps = $false
    windowsStoreEnablePrivateStoreOnly = $false
    storageRestrictAppDataToSystemVolume = $false
    storageRestrictAppInstallToSystemVolume = $false
    gameDvrBlocked = $false
    experienceBlockDeviceDiscovery = $false
    experienceBlockErrorDialogWhenNoSIM = $false
    experienceBlockTaskSwitcher = $false
    logonBlockFastUserSwitching = $false
    tenantLockdownRequireNetworkDuringOutOfBoxExperience = $false
}

New-MgDeviceManagementDeviceConfiguration -BodyParameter $params

$Config = Get-MgDeviceManagementDeviceConfiguration | Where-Object DisplayName -eq "Windows 10 General Configuration - Test"
Remove-MgDeviceManagementDeviceConfiguration -DeviceConfigurationId $Config.Id
